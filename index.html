<!doctype html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Ch√∫c m·ª´ng sinh nh·∫≠t!</title>
    <style>
    :root{
    --bg1:#0f172a;
    --bg2:#7c3aed;
    --accent:#ffdd57;
    --card:#0b1220;
    color-scheme: dark;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{
    background: linear-gradient(180deg,var(--bg1) 0%, #2b2b5f 40%, var(--bg2) 100%);
    display:flex;align-items:center;justify-content:center;overflow:hidden;padding:20px;
    }

    .card{
    width:min(980px,96%);
    min-height:540px;
    background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
    border-radius:18px; padding:28px; position:relative; box-shadow:0 10px 40px rgba(2,6,23,0.6);
    border:1px solid rgba(255,255,255,0.04);
    overflow:hidden;
    }

    .headline{font-size:clamp(28px,4vw,44px); font-weight:700; color: #fff; text-align:center; margin-top:6px}
    .sub{color:rgba(255,255,255,0.75); text-align:center; margin-top:6px}

    .stage{display:flex;align-items:flex-end;justify-content:center; gap:40px; margin-top:22px}

    /* b√°nh kem */
    .cake{
    width:320px;
    background: linear-gradient(#fff9f0,#ffeedd);
    border-radius:12px; padding:24px;
    position:relative; box-shadow:0 8px 30px rgba(0,0,0,0.35);
    }
    .cake .layer{height:72px; border-radius:10px; background:linear-gradient(#ffd6c7,#ffb9a0); margin-bottom:8px; position:relative}
    .frost{position:absolute;inset:0;border-radius:10px;
    background: repeating-linear-gradient(120deg, rgba(255,255,255,0.18) 0 6px, rgba(255,255,255,0.06) 6px 12px);
    mix-blend-mode:overlay}

    /* n·∫øn */
    .layer.top-layer{position:relative;}
    .candles{display:flex;gap:12px; justify-content:center;
    position:absolute; top:-50px; left:50%; transform:translateX(-50%);}
    .candle{width:14px;height:50px;border-radius:4px;background:linear-gradient(#fff,#ffeaea);position:relative;}
    .candle::before{content:'';position:absolute; top:-14px; width:6px;height:14px; border-radius:3px; background:var(--accent);}
    .flame{position:absolute; top:-26px; width:12px; height:20px; animation:flame 200ms infinite alternate}
    @keyframes flame{from{transform:translateY(0) scale(0.95); opacity:0.9} to{transform:translateY(-4px) scale(1.05); opacity:1}}

    .name{font-weight:800; font-size:26px; text-align:center; margin-top:18px; color:#fff;
    text-shadow:0 4px 30px rgba(124,58,237,0.45)}

    canvas#confetti{ position:absolute; inset:0; width:100%; height:100%; pointer-events:none}

    /* balloons */
    .balloon{position:absolute; bottom:40px; width:90px; height:120px; border-radius:60% 60% 55% 55%; opacity:0.95;}
    .balloon .string{position:absolute; bottom:-60px; width:2px; height:60px; background:rgba(255,255,255,0.15); left:50%; transform:translateX(-50%)}
    .float-1{left:8%; animation:float 6s ease-in-out infinite}
    .float-2{right:14%; animation:float 5.2s ease-in-out infinite}
    .float-3{left:26%; animation:float 7.5s ease-in-out infinite}
    @keyframes float{0%{transform:translateY(0)}50%{transform:translateY(-20px)}100%{transform:translateY(0)}}

    .controls{position:absolute; right:22px; top:18px; display:flex; gap:8px}
    .btn{background:rgba(255,255,255,0.06); color:#fff; border:1px solid rgba(255,255,255,0.04); padding:8px 12px; border-radius:10px; cursor:pointer}
    .btn:active{transform:translateY(1px)}

    .message{position:absolute; left:28px; bottom:18px; right:28px; text-align:center}
    .typed{font-size:20px; color: #fff; opacity:0.95}

    @media (max-width:640px){
    .stage{flex-direction:column}
    .cake{width:86%}
    }
    </style>
</head>
<body>
    <div class="card" id="card">
    <canvas id="confetti"></canvas>

    <div class="controls">
    <button class="btn" id="playBtn">Ph√°t nh·∫°c</button>
    <button class="btn" id="stopBtn">D·ª´ng nh·∫°c</button>
    <button class="btn" id="screenshotBtn">T·∫£i ·∫£nh</button>
    </div>

    <h1 class="headline">Ch√∫c m·ª´ng sinh nh·∫≠t b·∫°n V≈© ƒê·∫°t!</h1>
    <div class="stage">
    <div class="cake">
    <!-- t·∫ßng tr√™n c√πng -->
    <div class="layer top-layer">
    <div class="frost"></div>
    <div class="candles" id="candles"></div>
    </div>
    <!-- t·∫ßng d∆∞·ªõi -->
    <div class="layer"><div class="frost"></div></div>

    <div class="name" id="toName">Ch√∫c m·ª´ng sinh nh·∫≠t b·∫°n V≈© ƒê·∫°t</div>
    </div>

    <!-- Qu√† t·∫∑ng c√≥ h√¨nh ·∫£nh -->
    <div style="display:flex;flex-direction:column;align-items:center;gap:8px">
    <div style="width:120px;height:120px;border-radius:12px;background:#fff;display:flex;align-items:center;justify-content:center;overflow:hidden;box-shadow:0 6px 20px rgba(0,0,0,0.28)">
    <img src="https://cdn.pixabay.com/animation/2023/11/29/03/39/03-39-03-19_512.gif" alt="·∫¢nh qu√†" style="width:100%;height:100%;object-fit:cover">
    </div>
    <div style="color:rgba(255,255,255,0.9);">Qu√† t·∫∑ng</div>
    </div>
    </div>

    <div class="message">
    <div class="typed" id="typedText">Nh·∫•n "Ph√°t nh·∫°c" ho·∫∑c nh·∫•n v√†o b√°nh ƒë·ªÉ th·∫Øp n·∫øn!</div>
    </div>

    <div class="balloon float-1" style="left:6%; background: radial-gradient(circle at 30% 25%, rgba(255,255,255,0.35), rgba(255,0,100,0.9));"><div class="string"></div></div>
    <div class="balloon float-2" style="right:12%; background: radial-gradient(circle at 30% 25%, rgba(255,255,255,0.35), rgba(0,200,255,0.9));"><div class="string"></div></div>
    <div class="balloon float-3" style="left:28%; background: radial-gradient(circle at 30% 25%, rgba(255,255,255,0.35), rgba(255,180,50,0.95));"><div class="string"></div></div>
    </div>

<script>
// --- N·∫øn ---
const candlesContainer = document.getElementById('candles');
for(let i=0;i<6;i++){
    const c = document.createElement('div'); c.className='candle';
    const flame = document.createElement('div'); flame.className='flame';
    flame.innerHTML = `<svg width="16" height="20" xmlns="http://www.w3.org/2000/svg">
    <path d="M8 0c2.5 3.2 2.2 6.6 0 9-2.2-2.4-2.5-5.8 0-9z" fill="#ff8a00"/>
    <path d="M8 3c1.2 1.5 1 3 0 4-1-1-1.2-2.5 0-4z" fill="#ffd23f"/>
    </svg>`;
    c.appendChild(flame);
    candlesContainer.appendChild(c);
}

// --- Nh·∫°c sinh nh·∫≠t (file mp3) ---
let audio = new Audio("./ChucMungSinhNhat-PhanDinhTung-2804028.mp3"); 
audio.loop = true;
const playBtn=document.getElementById('playBtn'), stopBtn=document.getElementById('stopBtn');
playBtn.addEventListener('click',()=>{audio.play(); startConfetti(140); startTyping("Ch√∫c V≈© ƒê·∫°t c√≥ m·ªôt ng√†y sinh nh·∫≠t th·∫≠t ƒë√°ng nh·ªõ! üéÇü•≥")});
stopBtn.addEventListener('click',()=>{audio.pause(); audio.currentTime=0});

// --- Typing effect ---
const typedEl=document.getElementById('typedText');
function startTyping(text){
    typedEl.textContent=''; let i=0; clearInterval(window._typingInterval);
    window._typingInterval=setInterval(()=>{
    typedEl.textContent=text.slice(0,i+1); i++; if(i>=text.length) clearInterval(window._typingInterval);
    },40);
}
document.querySelector('.cake').addEventListener('click',()=>{
    startConfetti(160);
    startTyping("Ch√∫c V≈© ƒê·∫°t m·ªôt sinh nh·∫≠t vui v·∫ª, nhi·ªÅu s·ª©c kh·ªèe v√† h·∫°nh ph√∫c! üéâ");
    audio.play();
});

// --- Confetti ---
const confettiCanvas=document.getElementById('confetti');
const ctx=confettiCanvas.getContext('2d');
let W=0,H=0; function resize(){W=confettiCanvas.width=confettiCanvas.clientWidth;H=confettiCanvas.height=confettiCanvas.clientHeight}
new ResizeObserver(resize).observe(confettiCanvas);
const colors=['#ff3b3b','#ff8a00','#ffd23f','#60ff9a','#7c3aed','#00d4ff'];
let confettiParticles=[];
function random(min,max){return Math.random()*(max-min)+min}
function startConfetti(amount=100){
    confettiParticles=[];
    for(let i=0;i<amount;i++){
    confettiParticles.push({x:random(0,W),y:random(-H,0),vx:random(-2,2),vy:random(2,6),size:random(6,12),color:colors[Math.floor(Math.random()*colors.length)],rot:random(0,360),vr:random(-6,6)});
    }
    if(!window._confettiRunning) animateConfetti();
}
function animateConfetti(){
    window._confettiRunning=true;
    ctx.clearRect(0,0,W,H);
    for(let p of confettiParticles){
    p.x+=p.vx; p.y+=p.vy; p.rot+=p.vr*0.1; p.vy+=0.06;
    if(p.y>H+30){p.y=random(-200,-10); p.x=random(0,W); p.vy=random(2,6)}
    ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot*Math.PI/180);
    ctx.fillStyle=p.color; ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size*0.6);
    ctx.restore();
    }
    requestAnimationFrame(animateConfetti);
}
startConfetti(40);

// --- Screenshot ---
document.getElementById('screenshotBtn').addEventListener('click', () => {
  // l·∫•y ph·∫ßn t·ª≠ img ch·ª©a ·∫£nh
const img = document.querySelector('#card img'); 
if(img){
    const a = document.createElement('a');
    a.href = img.src;          // link ·∫£nh g·ªëc
    a.download = "./img/ƒê·∫°t.jpg"; // t√™n file t·∫£i v·ªÅ
    a.click();
} else {
    alert("Kh√¥ng t√¨m th·∫•y ·∫£nh trong card!");
}
});
</script>
</body>
</html>
